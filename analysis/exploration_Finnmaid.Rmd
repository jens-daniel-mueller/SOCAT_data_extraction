---
title: "Read synthesis files"
author: "Jens Daniel MÃ¼ller"
date:  "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  workflowr::wflow_html:
    number_sections: true
    toc_depth: 3
    toc_float:
      collapsed: false
editor_options:
  chunk_output_type: console
---

```{r libraries, include=FALSE}

library(tidyverse)

```

```{r set_theme, include=FALSE}

theme_set(theme_bw())

```


# Set path

```{r set_path}

path_SOCAT <- "/nfs/kryo/work/updata/SOCAT/"
print(path_SOCAT)

```


# Read files

```{r read_files}

df <-
  read_csv(paste0(path_SOCAT, "SOCATv2021_Baltic_Finnmaid.csv"))


df <- df %>% 
  drop_na()

```


# Track

```{r track}

df %>%
  ggplot(aes(lon, lat)) +
           geom_bin2d(binwidth = 0.1) +
           scale_fill_viridis_c() +
           coord_quickmap(expand = 0)
         

```

# Monthly climatologies

```{r climatologies}

vars <- c("fCO2", "SST", "sal")

for (i_var in vars) {
  # i_var <- vars[1]
  
  df %>%
    ggplot(aes(mon, lat, z = !!sym(i_var))) +
    stat_summary_2d() +
    scale_fill_viridis_c(name = i_var) +
    coord_cartesian(expand = 0)
}



```

## Regional time series

```{r regional_time_series, eval=FALSE}

df <- df %>% 
  mutate(Area = case_when(
    Lon>12 & Lon<12.6 ~ "1.MEB",
    Lon>13.1 & Lon<14.3 ~ "2.ARK",
    Lat>57.5 & Lat<58.5 & route %in% c("E", "G") ~ "4.EGS",
    Lat>56.8 & Lat<57.5 & route=="W" ~ "3.WGS",
    Lat>58.5 & Lat<59 & Lon>20 ~ "5.NGS",
    Lon>22 & Lon<24 ~ "6.WGF",
    Lon>24 & Lon<24.5 ~ "7.HGF"))

```

